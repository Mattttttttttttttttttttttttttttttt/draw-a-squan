<!DOCTYPE html>
<html>
<head>
<style>
  * { box-sizing: border-box; }
  body { background: #1a1a1a; padding: 30px; font-family: monospace; color: #aaa; margin: 0; }
  .layout { display: flex; gap: 40px; align-items: flex-start; flex-wrap: wrap; }
  .controls { display: flex; flex-direction: column; gap: 14px; min-width: 280px; }
  .group { background: #222; border-radius: 8px; padding: 14px; display: flex; flex-direction: column; gap: 10px; }
  .group-title { color: #fff; font-size: 12px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 2px; }
  .row { display: flex; align-items: center; gap: 10px; }
  .row label { width: 80px; font-size: 12px; color: #888; }
  .row input[type=range] { flex: 1; accent-color: #4ecdc4; width: 900px;}
  .row span { width: 48px; text-align: right; font-size: 12px; color: #fff; }
  .canvases { display: flex; gap: 30px; flex-wrap: wrap; }
  .piece { display: flex; flex-direction: column; align-items: center; gap: 8px; }
  .piece label { font-size: 12px; color: #aaa; }
  svg.preview { background: #2a2a2a; border-radius: 8px; }
  .crosshair { pointer-events: none; }
</style>
</head>
<body>
<div class="layout">
  <div class="controls">
    <div class="group">
      <div class="group-title">Corner</div>
      <div class="row"><label>size</label><input type="range" id="cSize" min="20" max="200" value="96" step="1"><span id="cSizeV"></span></div>
      <div class="row"><label>origin x</label><input type="range" id="cOx" min="-500" max="500" value="-3.5" step="0.5"><span id="cOxV"></span></div>
      <div class="row"><label>origin y</label><input type="range" id="cOy" min="-500" max="500" value="103.5" step="0.5"><span id="cOyV"></span></div>
    </div>
    <div class="group">
      <div class="group-title">Edge</div>
      <div class="row"><label>size</label><input type="range" id="eSize" min="20" max="200" value="54" step="1"><span id="eSizeV"></span></div>
      <div class="row"><label>origin x</label><input type="range" id="eOx" min="-500" max="500" value="50" step="0.5"><span id="eOxV"></span></div>
      <div class="row"><label>origin y</label><input type="range" id="eOy" min="-500" max="500" value="117" step="0.5"><span id="eOyV"></span></div>
    </div>
    <div class="group">
      <div class="group-title">Slice</div>
      <div class="row"><label>rel. scale</label><input type="range" id="sSize" min="10" max="300" value="196.5" step="0.5"><span id="sSizeV"></span></div>
      <div class="row"><label>offset x</label><input type="range" id="sOx" min="-110" max="110" value="-42" step="0.5"><span id="sOxV"></span></div>
      <div class="row"><label>offset y</label><input type="range" id="sOy" min="-200" max="0" value="-123.5" step="0.5"><span id="sOyV"></span></div>
    </div>
    <div class="group" style="font-size:11px; color:#666; line-height:1.6;">
      origin = the point that will sit at (0,0) in drawLayer<br>
      red dot = corner origin · orange dot = slice origin<br>
      crosshair = centre of preview svg<br>
      slice: rel.scale % controls relativeSliceScale in drawScramble.js<br>
      scale = (viewBoxSize/220) × 0.89 × (relScale/100) — offsets are direct SVG units
    </div>
  </div>

  <div class="canvases">
    <div class="piece"><label>CANVAS</label><svg id="svg" class="preview" width="1100" height="1100" viewBox="-110 -110 220 220"></svg></div>
  </div>
</div>

<script>
  const ids = ['cSize','cOx','cOy','eSize','eOx','eOy','sSize','sOx','sOy'];
  const vals = {};

  function v(id) { return parseFloat(document.getElementById(id).value); }

  function update() {
    ids.forEach(id => {
      vals[id] = v(id);
      document.getElementById(id+'V').textContent = v(id).toFixed(1);
    });
    drawPieces();
  }

  function crosshair(svg) {
    return `<line class="crosshair" x1="-110" y1="0" x2="110" y2="0" stroke="#444" stroke-width="0.5"/>
            <line class="crosshair" x1="0" y1="-110" x2="0" y2="110" stroke="#444" stroke-width="0.5"/>`;
  }

  function drawPieces() {
    const svg = document.getElementById('svg');
    let size = vals.cSize;
    let scale = size / 48.5;
    // origin in viewBox coords (as % of 48.5)
    let ox = (vals.cOx / 100) * 48.5;
    let oy = (vals.cOy / 100) * 48.5;
    let tx = -ox * scale;
    let ty = -oy * scale;

    svg.innerHTML = crosshair() + `
      <g transform="translate(${tx.toFixed(2)},${ty.toFixed(2)}) scale(${scale.toFixed(4)})">
        <path d="M10.19,2.45l-2.86,10.68h24.73c1.83,0,3.31,1.48,3.31,3.31v24.73l10.68-2.86c1.45-.39,2.45-1.7,2.45-3.2V3.31c0-1.83-1.48-3.31-3.31-3.31H13.39c-1.5,0-2.81,1.01-3.2,2.45Z" fill="black"/>
        <path d="M7.26,13.39L.25,39.56c-1.41,5.28,3.42,10.11,8.7,8.7l26.16-7.01c1.45-.39,2.45-1.7,2.45-3.2V14.25c0-1.83-1.48-3.31-3.31-3.31H10.46c-1.5,0-2.81,1.01-3.2,2.45Z" fill="black"/>
        <path d="M35.2,10.94c.52,0,1.01-.21,1.38-.57l.71-.71,5.72-5.72c.64-.64.19-1.73-.72-1.73H14.03c-.88,0-1.66.59-1.88,1.45l-.78,2.92-.51,1.91c-.33,1.24.6,2.45,1.88,2.45h22.47Z" fill="#00ff44"/>
        <path d="M37.57,35.77c0,1.28,1.22,2.22,2.45,1.88l1.91-.51,2.92-.78c.85-.23,1.45-1,1.45-1.88V6.21c0-.9-1.09-1.36-1.73-.72l-5.72,5.72-.71.71c-.37.37-.57.86-.57,1.38v22.47Z" fill="red"/>
        <path d="M33.92,39.28c.85-.23,1.45-1,1.45-1.88V15.09c0-1.08-.87-1.95-1.95-1.95H11.1c-.88,0-1.66.59-1.88,1.45l-7,26.12c-.91,3.39,2.19,6.49,5.58,5.58l26.12-7Z" fill="#4d4d4d"/>
      </g>
      <circle cx="0" cy="0" r="3" fill="red" opacity="0.9"/>`;
    size = vals.eSize;
    scale = size / 27;
    ox = (vals.eOx / 100) * 27;
    oy = (vals.eOy / 100) * 42.61;
    tx = -ox * scale;
    ty = -oy * scale;

    svg.innerHTML += `
      <g transform="translate(${tx.toFixed(2)},${ty.toFixed(2)}) scale(${scale.toFixed(4)})">
        <path d="M.11,4.17l2.4,8.97h21.97l2.4-8.97c.56-2.1-1.02-4.17-3.2-4.17H3.31C1.14,0-.45,2.07.11,4.17Z" fill="black"/>
        <path d="M3.05,15.11l6.57,24.52c1.07,3.98,6.71,3.98,7.77,0l6.57-24.52c.56-2.1-1.02-4.17-3.2-4.17H6.24c-2.18,0-3.76,2.07-3.2,4.17Z" fill="black"/>
        <path d="M21.3,10.94c.88,0,1.66-.59,1.88-1.45l.78-2.92.51-1.91c.33-1.24-.6-2.45-1.88-2.45H4.41c-1.28,0-2.22,1.22-1.88,2.45l.51,1.91.78,2.92c.23.85,1,1.45,1.88,1.45h15.6Z" fill="#00ff44"/>
        <path d="M19.67,13.14H7.34c-1.28,0-2.22,1.22-1.88,2.45l6.17,23.01c.52,1.93,3.25,1.93,3.77,0l6.17-23.01c.33-1.24-.6-2.45-1.88-2.45Z" fill="#4d4d4d"/>
      </g>
      <g transform="translate(${tx.toFixed(2)},${ty.toFixed(2)}) scale(${scale.toFixed(4)}) rotate(90,${ox.toFixed(2)},${oy.toFixed(2)})">
        <path d="M.11,4.17l2.4,8.97h21.97l2.4-8.97c.56-2.1-1.02-4.17-3.2-4.17H3.31C1.14,0-.45,2.07.11,4.17Z" fill="black"/>
        <path d="M3.05,15.11l6.57,24.52c1.07,3.98,6.71,3.98,7.77,0l6.57-24.52c.56-2.1-1.02-4.17-3.2-4.17H6.24c-2.18,0-3.76,2.07-3.2,4.17Z" fill="black"/>
        <path d="M21.3,10.94c.88,0,1.66-.59,1.88-1.45l.78-2.92.51-1.91c.33-1.24-.6-2.45-1.88-2.45H4.41c-1.28,0-2.22,1.22-1.88,2.45l.51,1.91.78,2.92c.23.85,1,1.45,1.88,1.45h15.6Z" fill="#00ff44"/>
        <path d="M19.67,13.14H7.34c-1.28,0-2.22,1.22-1.88,2.45l6.17,23.01c.52,1.93,3.25,1.93,3.77,0l6.17-23.01c.33-1.24-.6-2.45-1.88-2.45Z" fill="#4d4d4d"/>
      </g>`;

    // === SLICE ===
    // Mirrors drawScramble.js getSliceSVG: scale = (viewBoxSize/220) * 0.89 * relativeScale
    // viewBox here is 220 units wide (-110 to 110), so (220/220) = 1.
    // sSize slider is relativeScale × 100 (e.g. 100 → relScale=1 → scale=0.89).
    const sScale = vals.sSize / 100;
    const sTx = vals.sOx;
    const sTy = vals.sOy;

    svg.innerHTML += `
      <g transform="translate(${sTx.toFixed(2)},${sTy.toFixed(2)}) scale(${sScale.toFixed(4)}) rotate(-30)">
        <path d="M42.56,3.6c-.16-.97-.86-1.73-1.81-1.99L35.06.09c-.21-.06-.43-.09-.65-.09-.86,0-1.64.44-2.1,1.17-.46.73-.5,1.63-.13,2.4l1.97,4.05c.42.86,1.28,1.4,2.24,1.4.5,0,.98-.15,1.39-.43l3.73-2.53c.82-.55,1.22-1.5,1.06-2.47Z" fill="#888"/>
        <path d="M8.45,116.55c-.42-.86-1.28-1.4-2.24-1.4-.5,0-.98.15-1.39.43l-3.73,2.53c-.82.55-1.22,1.5-1.06,2.47.16.97.86,1.73,1.81,1.99l5.7,1.53c.21.06.43.09.65.09.86,0,1.64-.44,2.1-1.17.46-.73.5-1.63.13-2.4l-1.97-4.05Z" fill="#888"/>
        <path d="M40.37,3.06l-5.7-1.53c-.09-.02-.18-.04-.26-.04-.69,0-1.21.74-.88,1.42l1.97,4.05c.17.35.52.55.89.55.19,0,.38-.05.55-.17l3.73-2.53c.7-.47.52-1.55-.3-1.77Z" fill="#4d4d4d"/>
        <path d="M7.1,117.2c-.17-.35-.52-.55-.89-.55-.19,0-.38.05-.55.17l-3.73,2.53c-.7.47-.52,1.55.3,1.77l5.7,1.53c.09.02.18.04.26.04.69,0,1.21-.74.88-1.42l-1.97-4.05Z" fill="#4d4d4d"/>
      </g>`;
  }

  ids.forEach(id => document.getElementById(id).addEventListener('input', update));
  update();
</script>
</body>
</html>